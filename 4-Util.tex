\section{Utilities}
SunPy is meant to provide a consistent environment for solar data analysis. In order to
achieve this goal SunPy provides a number of utility functions which are used by the other
SunPy modules and are made available to the user. Two modules are described in this Section, 
namely, solar coordinates (coords), and the Sun module (sun). 
	
\subsection{Coordinates}
Coordinate transformations are frequently a necessary task within the solar data analysis
workflow. Likely the most often used transformation is from observer coordinates (e.g. 
sky coordinates) to a coordinate system which is mapped onto the solar surface (e.g.
latitude and longitude). This transformation is necessary to compare the true physical
distance between different solar features. This type of transformation is not unique
to solar observations (e.g. planetary) but it is not provided by the Astropy coordinates 
package. SunPy implements the World Coordinate System (WCS) for solar
coordinates as described by \cite{Thompson2000}. The coordinate system transformations
currently implemented as those most useful for most solar data analysis, namely 
converting from Helioprojective-Cartesian (HPC) to Heliographic coordinates (HG). HPC 
which describes the positions on the Sun as angles measured from the center of the solar 
disk (usually in arcseconds) using cartesian coordinates (X, Y). These are the coordinates 
most often defined in solar image data (e.g. SDO/AIA images, SOHO/EIT, TRACE). HG
coordinates express positions on the Sun using longitude and latitude on the solar 
sphere. There are two standards for this coordinate system, Stonyhurst-Heliographic 
where the origin is at the intersection of the solar equator and 
the central meridian as seen from Earth. Carrington-Heliographic is a system which is
fixed to the Sun and does not depend on Earth. The implementation of these transformations
pass through a common coordinate system called Heliocentric-Cartesian (HCC) where positions 
are expressed in true (deprojected) physical distances instead of angles on the celestial sphere.
These transformations require some knowledge of the location of the observer which is
usually provided by the image header information. In cases where it is not, the observer
is assumed to be at Earth. The current implementation is function-based and is used mostly
by the SunPy map object. A refactor to a more object-oriented API is planned for a future
release of SunPy.


\subsubsection{Sun}
The purpose of this module is to provide solar-specific data for example ephemeris and
solar constants. The main namespace contains a number of functions which provide solar
ephemeris such as sun to earth distance, solar cycle number, the mean anomaly, etc.
All of these functions take a time as their input which can be provided in any parse_time
compatible format. A future version of SunPy will integrate with the AstroPy coordinates package.


\subsubsection{constants}
The purpose of the constants package is to provide a number of solar-related constants 
in order to provide consistency in the calculations of derived solar values both within the
SunPy code base but also to the user. Every solar constants is provided as a Constant objects as defined by Astropy. 
Each Constant object defines a Quantity, a number associated with a unit, along with the constant's provenance
(i.e. reference) as well as its uncertainty. Using Astropy's Quantities, any solar constant
can easily be converted between different units as can be seen in Figure~\ref{fig:constants_code} as well
as between SI or cgs with a single command.  As these objects inherit from Numpy's ndarray,
they work well with standard representations of numbers.
For convenience a number shortcuts to frequently used constants are provided directly when importing
the sub-package. A larger list of constants can be accessed through an interface modelled 
on that provided by the SciPy constants package and are available as a dictionary called
physical_constants. To view all quickly a print_all() function is available.

\begin{listing}[h]
\begin{minted}{pycon}

>>> from sunpy.sun import constants as sun
>>> print(sun.mass)
  Name   = Solar mass
  Value  = 1.9891e+30
  Error  = 5e+25
  Units  = kg
  Reference = Allen's Astrophysical Quantities 4th Ed.
Verify the average density of the Sun and convert to cgs
>>> (sun.mass/sun.volume).cgs
<Quantity 1.40851154227 g / (cm3)>
Check to see if the age of the Sun is available and grab the unit and value separately
>>> sun.find('age')
['age', 'average angular size', 'average density', 'average intensity']
>>> sun.value('age'), sun.unit('age')

\end{minted}
\caption{Using sunpy.sun.constants sub-package.}
\label{code:constants_code}
\end{listing}
	